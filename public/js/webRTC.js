!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=7)}({7:function(e,t,n){e.exports=n("ww2S")},ww2S:function(e,t){var n,o=io("https://rtcserver.esuccess-inc.com:40002",{}),r=new Peer({initiator:!1,trickle:!1}),c={},i=document.querySelector("video"),a=document.querySelector("select#audioSource"),l=document.querySelector("select#audioOutput"),u=document.querySelector("select#videoSource"),d=[a,l,u];function s(e){var t=d.map((function(e){return e.value}));d.forEach((function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}));for(var n=0;n!==e.length;++n){var o=e[n],r=document.createElement("option");r.value=o.deviceId,"audioinput"===o.kind?(r.text=o.label||"microphone ".concat(a.length+1),a.appendChild(r)):"audiooutput"===o.kind?(r.text=o.label||"speaker ".concat(l.length+1),l.appendChild(r)):"videoinput"===o.kind?(r.text=o.label||"camera ".concat(u.length+1),u.appendChild(r)):console.log("Some other kind of source/device: ",o)}d.forEach((function(e,n){Array.prototype.slice.call(e.childNodes).some((function(e){return e.value===t[n]}))&&(e.value=t[n])}))}function m(e){return window.stream=e,i.srcObject=e,n=e,navigator.mediaDevices.enumerateDevices()}function f(e){console.log("navigator.MediaDevices.getUserMedia error: ",e.message,e.name)}function v(){window.stream&&window.stream.getTracks().forEach((function(e){e.stop()}));var e=a.value,t=u.value,n={audio:{deviceId:e?{exact:e}:void 0},video:{deviceId:t?{exact:t}:void 0}};navigator.mediaDevices.getUserMedia(n).then(m).then(s).catch(f)}function p(e,t){e.srcObject=t,e.addEventListener("loadedmetadata",(function(){e.play()})),videoGrid.append(e)}l.disabled=!("sinkId"in HTMLMediaElement.prototype),navigator.mediaDevices.enumerateDevices().then(s).catch(f),a.onchange=v,l.onchange=function(){var e,t,n=l.value;t=n,void 0!==(e=i).sinkId?e.setSinkId(t).then((function(){console.log("Success, audio output device attached: ".concat(t))})).catch((function(e){var t=e;"SecurityError"===e.name&&(t="You need to use HTTPS for selecting audio output device: ".concat(e)),console.error(t),l.selectedIndex=0})):console.warn("Browser does not support output device selection.")},u.onchange=v,v(),r.on("connection",(function(e){e.on("data",(function(e){console.log("peer connected",e)})),e.on("close",(function(){alert("close")}))})),r.on("open",(function(e){console.log("my peer id"+e),console.log("my user ",user),console.log("my room id ",roomID),myId=e,data={id:e,user:user,roomID:roomID},o.emit("newUser",data)})),r.on("call",(function(e){var t=0;e.answer(n),e.on("stream",(function(n){0==t&&(callerElement=document.createElement("video"),callerElement.setAttribute("id",e.peer),callerElement.setAttribute("class","callerVideo"),callerElement.muted=!1,p(callerElement,n)),t++}))})),r.on("close",(function(e){alert("close!")})),o.on("userJoined",(function(e){var t=e.id,o=(e.roomID,e.user,r.call(t,n));if(o){var i=0;o.on("stream",(function(t){0==i&&(callerElement=document.createElement("video"),callerElement.setAttribute("id",e.id),callerElement.setAttribute("class","callerBackVideo"),callerElement.muted=!1,p(callerElement,t)),i++})),o.on("close",(function(){document.getElementById(t).remove()})),o.on("error",(function(e){console.log(e)}))}c[t]=o})),o.on("userDisconnect",(function(e){c[e]&&(c[e].close(),document.getElementById(e).remove())}))}});
//# sourceMappingURL=webRTC.js.map