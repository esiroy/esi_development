!function(e){var n={};function o(t){if(n[t])return n[t].exports;var c=n[t]={i:t,l:!1,exports:{}};return e[t].call(c.exports,c,c.exports,o),c.l=!0,c.exports}o.m=e,o.c=n,o.d=function(e,n,t){o.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,n){if(1&n&&(e=o(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var c in e)o.d(t,c,function(n){return e[n]}.bind(null,c));return t},o.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(n,"a",n),n},o.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},o.p="/",o(o.s=7)}({7:function(e,n,o){e.exports=o("ww2S")},ww2S:function(e,n){var o,t=io("https://rtcserver.esuccess-inc.com:40002",{}),c=new Peer,r=document.getElementById("videoGrid"),i=document.createElement("video");i.setAttribute("id","myVideo");var d=document.createElement("video");d.setAttribute("id","sharedVideo");i.muted=!0;var a={};function u(){navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0}).then((function(e){sharedScreen=e,sharedScreen.getVideoTracks()[0].onended=function(){document.getElementById("sharedVideo").remove(),Object.keys(a).forEach((function(e){var n=c.connect(e);n.on("open",(function(){n.send(!1)}))}))},Object.keys(a).forEach((function(e){var n=c.connect(e);n.on("open",(function(){n.send(!0);var o=document.createElement("video");o.setAttribute("id","vid");var t=c.call(e,sharedScreen);t.on("error",(function(e){console.log(e)})),t.on("stream",(function(e){})),t.on("close",(function(){o.remove(),console.log("user disconect")}))}))})),function(e,n){e.srcObject=n,e.addEventListener("loadedmetadata",(function(){e.play()})),r.append(e)}(d,sharedScreen)}))}function l(e,n){e.srcObject=n,e.addEventListener("loadedmetadata",(function(){e.play()})),r.append(e)}t.on("connect",(function(){console.log("socket created "+t.id),console.log("my media created!"),navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then((function(e){o=e;var n=document.createElement("video");n.setAttribute("id","callerVideo"),l(i,o),c.on("connection",(function(e){e.on("data",(function(e){if(1!=e)return document.getElementById("sharedVideo").remove(),!1;(n=document.createElement("video")).setAttribute("id","sharedVideo"),console.log(e)}))})),c.on("close",(function(e){console.log("close")})),c.on("call",(function(o){console.log("called"),o.answer(e),o.on("stream",(function(e){l(n,e)})),o.on("finish",(function(){console.log("called finish")})),o.on("error",(function(e){alert(e)})),o.on("close",(function(){console.log(n),n.remove()})),a[o.peer]=o}))})).catch((function(e){alert(e.message)}))})),c.on("open",(function(e){console.log("my peer id"+e),e,t.emit("newUser",e,roomID)})),c.on("error",(function(e){console.log(e+" : "+e.type)})),t.on("userShared",(function(e,n){})),t.on("userJoined",(function(e){console.log("new user joined",e);var n=c.call(e,o),t=document.createElement("video");t.setAttribute("id","userVid"),n.on("error",(function(e){console.log(e)})),n.on("stream",(function(e){l(t,e)})),n.on("close",(function(){t.remove(),console.log("user disconected")})),a[e]=n})),t.on("userDisconnect",(function(e){a[e]&&a[e].close()})),document.getElementById("stopCamera").addEventListener("click",(function(){o.getVideoTracks().forEach((function(e){"live"==e.readyState?e.stop():console.log("video broadcasting live")})),o.getTracks().forEach((function(e){"live"==e.readyState?e.stop():console.log("audio not broadcasting live")}))})),document.getElementById("toggleCamera").addEventListener("click",(function(){o.getVideoTracks().forEach((function(e){e.enabled=!e.enabled,console.log(e)}))})),document.getElementById("toggleAudio").addEventListener("click",(function(){o.getAudioTracks().forEach((function(e){return e.enabled=!e.enabled}))})),document.getElementById("shareScreen").addEventListener("click",(function(){u()}))}});
//# sourceMappingURL=webRTC.js.map